
version: '2.2'                                                                                                                                                                                        
services:                                                                                                                                                                                             
  web:                                                                                                                                                                                                
    image: nginx                                                                                                                                                                                      
    volumes:                                                                                                                                                                                          
      - /home/ubuntu/vrm/instructions:/usr/share/nginx/html:ro                                                                                                                                        
    ports:                                                                                                                                                                                            
      - 80:80                                                                                                                                                                                         
  es:                                                                                                                                                                                                 
    image: docker.elastic.co/elasticsearch/elasticsearch:6.4.3                                                                                                                                        
    container_name: es                                                                                                                                                                                
    environment:                                                                                                                                                                                      
      - cluster.name=docker-cluster                                                                                                                                                                   
      - bootstrap.memory_lock=true                                                                                                                                                                    
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"                                                                                                                                                              
    ulimits:                                                                                                                                                                                          
      memlock:                                                                                                                                                                                        
        soft: -1                                                                                                                                                                                      
        hard: -1                                                                                                                                                                                      
    volumes:                                                                                                                                                                                          
      - vrmdata:/usr/share/elasticsearch/data                                                                                                                                                         
      - ./elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml                                                                                                                         
    ports:                                                                                                                                                                                            
      - 9200:9200                                                                                                                                                                                     
    networks:                                                                                                                                                                                         
      - esnet                                                                                                                                                                                         
  kibana:                                                                                                                                                                                             
    image: docker.elastic.co/kibana/kibana:6.4.3                                                                                                                                                      
    container_name: kibana                                                                                                                                                                            
    ports:                                                                                                                                                                                            
      - 5601:5601                                                                                                                                                                                     
    volumes:                                                                                                                                                                                          
      - ./kibana.yml:/usr/share/kibana/config/kibana.yml                                                                                                                                              
    networks:
                                                                                                                                                                                                      
volumes:                                                                                                                                                                                              
  vrmdata:                                                                                                                                                                                            
    driver: local                                                                                                                                                                                     
                                                                                                                                                                                                      
networks:                                                                                                                                                                                             
  esnet: 




